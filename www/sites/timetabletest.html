<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>
    <script src="../js/jquery-1.11.2.min.js"></script>
    <script src="../js/config.js"></script>
</head>
<body>


    <script>
         $.ajax({
            url: Config.get('url'),
            type: 'post',
            dataType: 'json',
            success: function(response) {
                if(response.updated) {
                    // update your local storage
                    // create or reopen file and store
					// the json object "response" in it
                    window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, gotFS, fail);
                    function gotFS(fileSystem) {
                        fileSystem.root.getFile("download/storage.json", {create: true, exclusive: false}, gotFileEntry, fail);
                    }
                    function gotFileEntry(fileEntry) {
                        fileEntry.createWriter(onWriterOpen, fail);
                    }
                } else {
                    // load local storage
                    
                }
                function onWriterOpen(writer){
                    writer.write("Test Write hope!");
                }

                function fail(error) {
                    console.log(error.code);
                }
            }, error: function(xhr, status, error) {
                // TODO popup, alert
                alert('error ' + xhr.responseText);
                console.log(xhr);
            }
        });
    </script>
</body>
</html>